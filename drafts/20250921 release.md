# 1

write a sh fn.

- called "release".
- param: a file
- for js, run
  - terser filename.js -o filename.min.js -c -m
- for html, run
  - node Documents/f/libraries/bundler.js filename.html temp.html
  - html-minifier --remove-comments --minify-css--minify-js --collapse-whitespace --conservative-collapse temp.html -o filename.min.html
- the output should be saved on the same path. temp should be removed.

---

Here's the shell function `release` that meets your requirements:

```sh
release() {
    file="$1"
    case "$file" in
        *.js)
            terser "$file" -o "${file%.js}.min.js" -c -m
            ;;
        *.html)
            temp_file="$(dirname "$file")/temp.html"
            node "$HOME/Documents/f/libraries/bundler.js" "$file" "$temp_file"
            html-minifier --remove-comments --minify-css --minify-js \
                --collapse-whitespace --conservative-collapse \
                "$temp_file" -o "${file%.html}.min.html"
            rm -f "$temp_file"
            ;;
        *)
            echo "Unsupported file type: $file" >&2
            return 1
            ;;
    esac
}
```

**Features:**

1. Handles both JS and HTML files with appropriate minification
2. Maintains original directory structure for output files
3. Automatically removes temporary HTML files
4. Provides error messaging for unsupported file types

**Usage:**

```sh
release path/to/file.js    # Creates path/to/file.min.js
release path/to/file.html  # Creates path/to/file.min.html
```

**Notes:**

- Ensure `terser`, `node`, and `html-minifier` are installed and available in your PATH
- The bundler script path is referenced from your home directory (`$HOME`)
- Preserves original file extension while adding `.min` before the extension
- Returns error code 1 and message for unsupported file types

You can add this function to your shell configuration file (e.g., `.bashrc` or `.zshrc`) or run it directly in your shell session.

# 2

(20250929)

modify the sh script

for html, save both filename.bundled.html and filename.bundled.min.html

instead of removing the temp bundled html

```
release() {
    file="$1"
    case "$file" in
        *.js)
            terser "$file" -o "${file%.js}.min.js" -c -m
            ;;
        *.html)
            temp_file="$(dirname "$file")/temp.html"
            node "$HOME/Documents/f/libraries/bundler.js" "$file" "$temp_file"
            html-minifier --remove-comments --minify-css --minify-js \
                --collapse-whitespace --conservative-collapse \
                "$temp_file" -o "${file%.html}.min.html"
            rm -f "$temp_file"
            ;;
        *)
            echo "Unsupported file type: $file" >&2
            return 1
            ;;
    esac
}
```

---

Here's the modified script that saves both the bundled and minified HTML files:

```bash
release() {
    file="$1"
    case "$file" in
        *.js)
            terser "$file" -o "${file%.js}.min.js" -c -m
            ;;
        *.html)
            bundled_file="${file%.html}.bundled.html"
            minified_file="${file%.html}.bundled.min.html"

            # Create bundled HTML
            node "$HOME/Documents/f/libraries/bundler.js" "$file" "$bundled_file"

            # Create minified version from the bundled HTML
            html-minifier --remove-comments --minify-css --minify-js \
                --collapse-whitespace --conservative-collapse \
                "$bundled_file" -o "$minified_file"
            ;;
        *)
            echo "Unsupported file type: $file" >&2
            return 1
            ;;
    esac
}
```

Key changes:

1. Removed the `temp_file` variable
2. Added `bundled_file` variable for the non-minified bundled HTML output
3. Added `minified_file` variable for the minified version
4. The bundler now outputs directly to the `bundled_file`
5. The minifier reads from the `bundled_file` and outputs to `minified_file`
6. Removed the `rm -f "$temp_file"` line since we want to keep both files

Now for an input file like `index.html`, you'll get:

- `index.bundled.html` (the bundled but non-minified version)
- `index.bundled.min.html` (the minified version)
