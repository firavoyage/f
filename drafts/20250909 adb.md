# 1

i have an android phone and an ubuntu desktop. how can i read the phone screen and write an automation script based on the phone screen

---

There are several ways to read your Android phone screen and create automation scripts from Ubuntu. Here are the most effective approaches:

## 1. Using scrcpy + ADB + OpenCV

This is the most powerful and flexible approach:

### Setup:

```bash
# Install scrcpy
sudo apt install scrcpy

# Install ADB
sudo apt install android-tools-adb

# Install Python dependencies
pip install opencv-python numpy pillow
```

### Basic script to capture screen:

```python
import subprocess
import cv2
import numpy as np
import time

def capture_phone_screen():
    # Start scrcpy server
    process = subprocess.Popen(['scrcpy', '--no-display', '--record', '-'])

    # Alternatively, use ADB screencap
    result = subprocess.run(['adb', 'exec-out', 'screencap', '-p'],
                          capture_output=True)
    image = cv2.imdecode(np.frombuffer(result.stdout, np.uint8), cv2.IMREAD_COLOR)
    return image

# Example usage
screen = capture_phone_screen()
cv2.imshow('Phone Screen', screen)
cv2.waitKey(0)
cv2.destroyAllWindows()
```

## 2. Using ADB Commands Directly

### Basic screen capture:

```bash
# Capture screenshot
adb exec-out screencap -p > screenshot.png

# Tap on coordinates
adb shell input tap 500 800

# Swipe
adb shell input swipe 100 500 300 500 100

# Text input
adb shell input text "hello"
```

### Python automation script:

```python
import subprocess
import time
import cv2

class PhoneAutomation:
    def __init__(self):
        self.check_adb_connection()

    def check_adb_connection(self):
        result = subprocess.run(['adb', 'devices'], capture_output=True, text=True)
        if 'device' not in result.stdout:
            print("Please connect your phone with USB debugging enabled")

    def screenshot(self, filename='screenshot.png'):
        subprocess.run(['adb', 'exec-out', 'screencap', '-p'], stdout=open(filename, 'wb'))
        return cv2.imread(filename)

    def tap(self, x, y):
        subprocess.run(['adb', 'shell', 'input', 'tap', str(x), str(y)])

    def swipe(self, x1, y1, x2, y2, duration=100):
        subprocess.run(['adb', 'shell', 'input', 'swipe', str(x1), str(y1), str(x2), str(y2), str(duration)])

    def input_text(self, text):
        subprocess.run(['adb', 'shell', 'input', 'text', text])

# Example usage
phone = PhoneAutomation()
phone.tap(500, 800)  # Tap at coordinates
time.sleep(1)
phone.input_text("Hello World")
```

## 3. Advanced: Template Matching with OpenCV

```python
import cv2
import numpy as np
import subprocess

def find_and_click(template_path, threshold=0.8):
    # Capture current screen
    subprocess.run(['adb', 'exec-out', 'screencap', '-p'], stdout=open('current_screen.png', 'wb'))
    screen = cv2.imread('current_screen.png')
    template = cv2.imread(template_path)

    # Template matching
    result = cv2.matchTemplate(screen, template, cv2.TM_CCOEFF_NORMED)
    min_val, max_val, min_loc, max_loc = cv2.minMaxLoc(result)

    if max_val >= threshold:
        # Get center of matched area
        h, w = template.shape[:2]
        center_x = max_loc[0] + w // 2
        center_y = max_loc[1] + h // 2

        # Click on the found position
        subprocess.run(['adb', 'shell', 'input', 'tap', str(center_x), str(center_y)])
        return True

    return False

# Usage: find_and_click('whatsapp_icon.png')
```

## 4. Using Appium for Advanced Automation

For more sophisticated automation, consider Appium:

```bash
# Install Appium
npm install -g appium
npm install -g appium-doctor

# Install Python client
pip install Appium-Python-Client
```

## Setup Requirements:

1. **Enable USB Debugging** on your Android phone:

   - Go to Settings → About Phone → Tap Build Number 7 times
   - Go to Developer Options → Enable USB Debugging

2. **Connect your phone**:

   ```bash
   adb devices
   # Allow USB debugging on your phone when prompted
   ```

3. **Install necessary tools**:
   ```bash
   sudo apt update
   sudo apt install android-tools-adb android-tools-fastboot scrcpy
   ```

## Example Complete Automation Script:

```python
import time
import subprocess
import cv2
import numpy as np

class PhoneController:
    def __init__(self):
        self.screen_size = self.get_screen_size()

    def get_screen_size(self):
        result = subprocess.run(['adb', 'shell', 'wm', 'size'],
                              capture_output=True, text=True)
        size_str = result.stdout.strip().split(': ')[1]
        w, h = map(int, size_str.split('x'))
        return (w, h)

    def capture_screen(self):
        result = subprocess.run(['adb', 'exec-out', 'screencap', '-p'],
                              capture_output=True)
        nparr = np.frombuffer(result.stdout, np.uint8)
        return cv2.imdecode(nparr, cv2.IMREAD_COLOR)

    def automate_task(self):
        # Example: Open WhatsApp and send message
        self.open_app('com.whatsapp')
        time.sleep(3)

        # Add your automation logic here
        # Use template matching or coordinate-based clicks

        print("Automation completed")

# Run automation
controller = PhoneController()
controller.automate_task()
```

This setup gives you a solid foundation for Android automation from Ubuntu. Start with simple ADB commands and gradually incorporate computer vision techniques for more sophisticated automation tasks.

# 2

can i not use python

---

Absolutely! You can automate Android phone tasks from Ubuntu without Python. Here are several pure Bash/command-line approaches:

## 1. Pure ADB Bash Automation

Create a shell script (`phone_automation.sh`):

```bash
#!/bin/bash

# Function to take screenshot
screenshot() {
    adb exec-out screencap -p > "screenshot_$(date +%Y%m%d_%H%M%S).png"
    echo "Screenshot saved"
}

# Function to tap at coordinates
tap() {
    adb shell input tap $1 $2
    echo "Tapped at: $1, $2"
}

# Function to swipe
swipe() {
    adb shell input swipe $1 $2 $3 $4 $5
    echo "Swiped from $1,$2 to $3,$4 (duration: $5ms)"
}

# Function to input text
input_text() {
    adb shell input text "$1"
    echo "Text entered: $1"
}

# Function to press key
press_key() {
    adb shell input keyevent $1
    echo "Key pressed: $1"
}

# Example automation sequence
echo "Starting phone automation..."

# Take screenshot
screenshot

# Open app drawer (usually)
tap 500 1800

sleep 2

# Open Chrome (example coordinates)
tap 200 500

sleep 3

# Input URL
tap 300 100  # tap address bar
sleep 1
input_text "https://github.com"
press_key 66  # Enter key

sleep 5

# Take another screenshot
screenshot

echo "Automation completed!"
```

## 2. Menu-Driven Automation Script

```bash
#!/bin/bash

# Check if ADB is available
check_adb() {
    if ! command -v adb &> /dev/null; then
        echo "ADB not found! Please install android-tools-adb"
        exit 1
    fi

    # Check device connection
    devices=$(adb devices | grep -v "List of devices" | grep -c "device$")
    if [ $devices -eq 0 ]; then
        echo "No devices connected. Please connect your phone and enable USB debugging."
        exit 1
    fi
}

# Show main menu
show_menu() {
    clear
    echo "===================================="
    echo "    Android Phone Automation Tool    "
    echo "===================================="
    echo "1. Take Screenshot"
    echo "2. Tap on Screen"
    echo "3. Input Text"
    echo "4. Swipe"
    echo "5. Press Key"
    echo "6. Run Demo Automation"
    echo "7. Exit"
    echo "===================================="
    read -p "Choose an option (1-7): " choice

    case $choice in
        1) take_screenshot_menu ;;
        2) tap_menu ;;
        3) input_text_menu ;;
        4) swipe_menu ;;
        5) press_key_menu ;;
        6) run_demo ;;
        7) exit 0 ;;
        *) echo "Invalid option"; sleep 1; show_menu ;;
    esac
}

take_screenshot_menu() {
    read -p "Enter filename (default: screenshot.png): " filename
    filename=${filename:-screenshot.png}
    adb exec-out screencap -p > "$filename"
    echo "Screenshot saved as $filename"
    read -p "Press Enter to continue..."
    show_menu
}

tap_menu() {
    read -p "Enter X coordinate: " x
    read -p "Enter Y coordinate: " y
    adb shell input tap $x $y
    echo "Tapped at $x, $y"
    read -p "Press Enter to continue..."
    show_menu
}

input_text_menu() {
    read -p "Enter text to input: " text
    adb shell input text "$text"
    echo "Text entered: $text"
    read -p "Press Enter to continue..."
    show_menu
}

swipe_menu() {
    read -p "Start X: " x1
    read -p "Start Y: " y1
    read -p "End X: " x2
    read -p "End Y: " y2
    read -p "Duration (ms, default: 100): " duration
    duration=${duration:-100}
    adb shell input swipe $x1 $y1 $x2 $y2 $duration
    echo "Swiped from $x1,$y1 to $x2,$y2"
    read -p "Press Enter to continue..."
    show_menu
}

press_key_menu() {
    echo "Common key events:"
    echo "3 - Home, 4 - Back, 24 - Volume Up, 25 - Volume Down"
    echo "26 - Power, 66 - Enter, 67 - Backspace"
    read -p "Enter key event code: " keycode
    adb shell input keyevent $keycode
    echo "Pressed key: $keycode"
    read -p "Press Enter to continue..."
    show_menu
}

run_demo() {
    echo "Running demo automation..."

    # Home button
    adb shell input keyevent 3
    sleep 2

    # Open app drawer (typical coordinates)
    adb shell input tap 500 1800
    sleep 2

    # Take screenshot
    adb exec-out screencap -p > demo_screenshot.png
    echo "Demo screenshot saved"

    # Go home
    adb shell input keyevent 3
    sleep 1

    echo "Demo completed!"
    read -p "Press Enter to continue..."
    show_menu
}

# Main execution
check_adb
show_menu
```

## 3. Simple One-Liner Commands

You can also create individual scripts for common tasks:

**screenshot.sh:**

```bash
#!/bin/bash
adb exec-out screencap -p > screenshot_$(date +%Y%m%d_%H%M%S).png
```

**tap.sh:**

```bash
#!/bin/bash
adb shell input tap $1 $2
```

**text_input.sh:**

```bash
#!/bin/bash
adb shell input text "$1"
```

**swipe.sh:**

```bash
#!/bin/bash
adb shell input swipe $1 $2 $3 $4 ${5:-100}
```

## 4. Advanced Bash Automation with Loops

```bash
#!/bin/bash

# Automated app testing
test_app() {
    echo "Testing app: $1"

    # Launch app
    adb shell monkey -p $1 -c android.intent.category.LAUNCHER 1
    sleep 3

    # Take initial screenshot
    adb exec-out screencap -p > "${1}_start.png"

    # Simulate some interactions
    for i in {1..5}; do
        # Random tap within screen bounds
        x=$((RANDOM % 1000 + 100))
        y=$((RANDOM % 2000 + 100))
        adb shell input tap $x $y
        sleep 1
    done

    # Take final screenshot
    adb exec-out screencap -p > "${1}_end.png"

    # Go home
    adb shell input keyevent 3
}

# Test multiple apps
apps=("com.android.chrome" "com.android.calculator2" "com.android.dialer")

for app in "${apps[@]}"; do
    test_app "$app"
done
```

## 5. Useful ADB Commands Cheat Sheet

```bash
# Basic device info
adb devices
adb shell getprop ro.product.model
adb shell wm size

# Input events
adb shell input keyevent 3        # Home
adb shell input keyevent 4        # Back
adb shell input keyevent 26       # Power
adb shell input keyevent 24       # Volume Up
adb shell input keyevent 25       # Volume Down

# App management
adb shell pm list packages         # List all packages
adb shell am start -n com.package/.Activity  # Start app

# File operations
adb push localfile.txt /sdcard/   # Push file to phone
adb pull /sdcard/file.txt .       # Pull file from phone
```

## Setup Instructions:

1. **Enable USB Debugging** on your Android phone
2. **Install ADB** on Ubuntu:
   ```bash
   sudo apt update
   sudo apt install android-tools-adb
   ```
3. **Connect your phone** and allow USB debugging
4. **Make scripts executable**:
   ```bash
   chmod +x phone_automation.sh
   chmod +x screenshot.sh
   chmod +x tap.sh
   ```
5. **Run your automation**:
   ```bash
   ./phone_automation.sh
   ```

These pure Bash solutions give you complete automation capabilities without any Python dependencies!
