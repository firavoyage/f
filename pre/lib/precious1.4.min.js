(()=>{const e={'"':'\\text{"}',"=":"=","!=":"\\neq","<":"<",">":">","<=":"\\leq",">=":"\\geq","â‰ˆ":"\\approx","~":"\\sim",alpha:"\\alpha",beta:"\\beta",gamma:"\\gamma",delta:"\\delta",epsilon:"\\epsilon",zeta:"\\zeta",eta:"\\eta",theta:"\\theta",iota:"\\iota",kappa:"\\kappa",lambda:"\\lambda",mu:"\\mu",nu:"\\nu",xi:"\\xi",omicron:"\\omicron",pi:"\\pi",rho:"\\rho",sigma:"\\sigma",tau:"\\tau",upsilon:"\\upsilon",phi:"\\phi",chi:"\\chi",psi:"\\psi",omega:"\\omega",Gamma:"\\Gamma",Delta:"\\Delta",Theta:"\\Theta",Lambda:"\\Lambda",Xi:"\\Xi",Pi:"\\Pi",Sigma:"\\Sigma",Upsilon:"\\Upsilon",Phi:"\\Phi",Psi:"\\Psi",Omega:"\\Omega",infinity:"\\infty",infty:"\\infty",inf:"\\infty",partial:"\\partial",nabla:"\\nabla",in:"\\in",notin:"\\notin",subset:"\\subset",subseteq:"\\subseteq",supset:"\\supset",supseteq:"\\supseteq",cup:"\\cup",cap:"\\cap",emptyset:"\\emptyset",forall:"\\forall",exists:"\\exists",nexists:"\\nexists",and:"\\land",or:"\\lor",not:"\\lnot",implies:"\\implies",iff:"\\iff",int:"\\int",oint:"\\oint",prod:"\\prod",lim:"\\lim",nabla:"\\nabla",langle:"\\langle",rangle:"\\rangle",to:"\\to",rightarrow:"\\rightarrow",leftarrow:"\\leftarrow",leftrightarrow:"\\leftrightarrow",Rightarrow:"\\Rightarrow",Leftarrow:"\\Leftarrow",Leftrightarrow:"\\Leftrightarrow","->":"\\rightarrow","<-":"\\leftarrow","<->":"\\leftrightarrow","=>":"\\Rightarrow","<=>":"\\Leftrightarrow",cdot:"\\cdot",pm:"\\pm",mp:"\\mp",times:"\\times",div:"\\div",circ:"\\circ",deg:"^\\circ",prime:"\\prime",ldots:"\\ldots",cdots:"\\cdots",vdots:"\\vdots",ddots:"\\ddots",perp:"\\perp",parallel:"\\parallel",angle:"\\angle",triangle:"\\triangle",congruent:"\\cong",similar:"\\sim",propto:"\\propto"};for(const t of Object.keys(e))e[t]=` ${e[t]} `;const t=[["_"],["^"],["//","%%"],["*","/"]],r={"^":(e,t)=>`{${e}}^{${a(t)}}`,_:(e,t)=>`{${e}}_{${a(t)}}`,"//":(e,t)=>`\\lfloor\\frac{${e}}{${t}}\\rfloor`,"%%":(e,t)=>`${e} \\bmod ${t}`,"*":(e,t)=>`${e} \\cdot ${t}`,"/":(e,t)=>`\\frac{${a(e)}}{${a(t)}}`},i={brace(...e){let t=e.join(",");return t.includes("\\\\")?(t.startsWith("\\\\")&&(t=t.slice(2)),t.endsWith("\\\\")&&(t=t.slice(0,-2)),t.includes("&")?`\\begin{cases}${t}\\end{cases}`:`\\left\\{\\begin{array}{l}${t}\\end{array}\\right.`):`\\{${t}\\}`},max(...e){if(1==e.length){const t=e[0];return`\\max ${l(t)}`}if(2==e.length){const t=e[0];return`\\max \\limits_{${e[1]}} ${l(t)}`}},min(...e){if(1==e.length){const t=e[0];return`\\min ${l(t)}`}if(2==e.length){const t=e[0];return`\\min \\limits_{${e[1]}} ${l(t)}`}},sum:(e,t,r)=>`\\sum_{${e}}^{${t}}{${l(r)}}`,v:e=>`\\vec{${e}}`,case:e=>`{${e}}^{\\circ}`,sqrt:e=>`\\sqrt{${e}}`,root:(e,t)=>`\\sqrt{${e}}{${t}}`,log:(e,t)=>`\\log_{${e}}{${l(t)}}`,ln:e=>`\\ln{${l(e)}}`,sin:e=>`\\sin{${l(e)}}`,cos:e=>`\\cos{${l(e)}}`,tan:e=>`\\tan{${l(e)}}`,abs:e=>`|${e}|`,floor:e=>`\\lfloor ${e} \\rfloor`,ceil:e=>`\\lceil ${e} \\rceil`},l=e=>{let t,r=e;do{t=r.length,r=r.replace(/\([^()]*\)/g,"").replace(/\[[^\[\]]*\]/g,"").replace(/\{[^{}]*\}/g,"")}while(r.length<t);return["+","-","\\times","\\cdot","\\ast","\\star","\\div","\\pm","\\mp","\\oplus","\\ominus","\\otimes","\\oslash","\\odot","\\circ","\\bullet","\\dagger","\\ddagger","\\cap","\\cup","\\sqcap","\\sqcup","\\uplus","\\bigcirc","\\bigtriangleup","\\bigtriangledown","\\wr","\\amalg"].some((e=>r.includes(e)))?`(${e})`:e},a=e=>{if(e.length<2||"("!==e[0]||")"!==e[e.length-1])return e;let t=0;for(let r=0;r<e.length;r++)if("("===e[r])t++;else if(")"===e[r]&&(t--,0===t&&r!==e.length-1))return e;return 0===t?e.slice(1,-1):e},s=e=>{const t=Symbol();return"string"!=typeof e?t:/[\u4E00-\u9FFF\u3040-\u309F\u30A0-\u30FF\uAC00-\uD7AF]/.test(e)?"text":/^[0-9.]+$/.test(e)?"number":/^[a-zA-Z]+$/.test(e)?"variable":["(",")","[","]","{","}"].includes(e)?t:"symbol"},n=(e,t,r,i)=>{for(;;){let l=-1,a=-1;for(let t=0;t<e.length;t++)if("("===e[t])l=t;else if(")"===e[t]){if(-1===l)throw new Error("Unmatched closing parenthesis");a=t;break}if(-1===a){if(-1!==l)throw new Error("Unmatched opening parenthesis");break}const s=e.slice(l+1,a);let o=null;if(l>0&&e[l-1]in i&&(o=e[l-1]),o){const c=[];let p=0,g=0;for(let e=0;e<s.length;e++){const t=s[e];"("===t?g++:")"===t?g--:","===t&&0===g&&(c.push(s.slice(p,e)),p=e+1)}c.push(s.slice(p));const m=c.map((e=>n(e,t,r,i))),u=i[o](...m);e.splice(l-1,a-l+2,u)}else{const o=`(${n(s,t,r,i)})`;e.splice(l,a-l+1,o)}}for(const i of t){const t=new Set(i);let l=0;for(;l<e.length;)if(t.has(e[l])){if(l-1<0||l+1>=e.length)throw new Error(`Operator '${e[l]}' at position ${l} is missing an operand`);const t=e[l-1],i=e[l+1],a=e[l],s=r[a](t,i);e.splice(l-1,3,s),l=0}else l++}return e.join("")};globalThis.precious=l=>(l=((e,t)=>e.map((e=>t[e.replaceAll(" ","")]??e)))(l=(l=((e,t)=>{const r=[];for(let i=0;i<e.length;i++)r.push(...e[i]),i<e.length-1&&r.push(t);return r})(l=(l=(l=(l=l.replaceAll("{","brace(").replaceAll("}",")")).replaceAll("[","preciousbracketbegin(").replaceAll("]",")preciousbracketend")).split("\n").map((e=>e.split(/\s+/).join(" ")))).map((e=>(e=>{if(0===e.length)return[];const t=[];let r=e[0],i=s(e[0]);for(let l=1;l<e.length;l++){const a=e[l],n=s(a);n===i?r+=a:(t.push(r),r=a,i=n)}return t.push(r),t})(e))),"\\\\")).map((e=>" "==e?" ":e.replaceAll(" ",""))),e),l=l.map(((e,t)=>" "==e&&"symbol"!=s(l[t-1])&&"symbol"!=s(l[t+1])?" \\: ":e)),l=(l=n(l,t,r,i)).replaceAll("preciousbracketbegin(","[").replaceAll(")preciousbracketend","]"))})();